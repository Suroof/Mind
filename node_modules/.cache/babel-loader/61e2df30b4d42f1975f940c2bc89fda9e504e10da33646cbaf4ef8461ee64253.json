{"ast":null,"code":"export const findTopicById = (root, id) => {\n  if (!root) return null;\n  if (root.id === id) return root;\n  for (const child of root.children) {\n    const found = findTopicById(child, id);\n    if (found) return found;\n  }\n  return null;\n};\nexport const countIncompleteTopics = topic => {\n  let count = topic.isCompleted ? 0 : 1;\n  for (const child of topic.children) {\n    count += countIncompleteTopics(child);\n  }\n  return count;\n};\nexport const updateParentProgress = topic => {\n  if (!topic.parent) return;\n  const allChildrenCompleted = topic.parent.children.every(child => child.isCompleted);\n  topic.parent.isCompleted = allChildrenCompleted;\n  updateParentProgress(topic.parent);\n};\nexport const showNotification = message => {\n  // 可以使用第三方通知库，这里用简单的 alert 演示\n  alert(message);\n};\n\n// 新增：检查是否存在循环引用\nexport const isDescendant = (parent, child) => {\n  // 检查 child 是否是 parent 的后代\n  if (parent.id === child.id) return true;\n  for (const descendant of parent.children) {\n    if (isDescendant(descendant, child)) return true;\n  }\n  return false;\n};","map":{"version":3,"names":["findTopicById","root","id","child","children","found","countIncompleteTopics","topic","count","isCompleted","updateParentProgress","parent","allChildrenCompleted","every","showNotification","message","alert","isDescendant","descendant"],"sources":["D:/Work/SIWEI/src/utils/topicUtils.ts"],"sourcesContent":["import { Topic } from '../types/MindMap';\r\n\r\nexport const findTopicById = (root: Topic | undefined | null, id: string): Topic | null => {\r\n  if (!root) return null;\r\n  if (root.id === id) return root;\r\n\r\n  for (const child of root.children) {\r\n    const found = findTopicById(child, id);\r\n    if (found) return found;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport const countIncompleteTopics = (topic: Topic): number => {\r\n  let count = topic.isCompleted ? 0 : 1;\r\n\r\n  for (const child of topic.children) {\r\n    count += countIncompleteTopics(child);\r\n  }\r\n\r\n  return count;\r\n};\r\n\r\nexport const updateParentProgress = (topic: Topic) => {\r\n  if (!topic.parent) return;\r\n\r\n  const allChildrenCompleted = topic.parent.children.every(child => child.isCompleted);\r\n  topic.parent.isCompleted = allChildrenCompleted;\r\n\r\n  updateParentProgress(topic.parent);\r\n};\r\n\r\nexport const showNotification = (message: string) => {\r\n  // 可以使用第三方通知库，这里用简单的 alert 演示\r\n  alert(message);\r\n};\r\n\r\n// 新增：检查是否存在循环引用\r\nexport const isDescendant = (parent: Topic, child: Topic): boolean => {\r\n  // 检查 child 是否是 parent 的后代\r\n  if (parent.id === child.id) return true;\r\n\r\n  for (const descendant of parent.children) {\r\n    if (isDescendant(descendant, child)) return true;\r\n  }\r\n\r\n  return false;\r\n};"],"mappings":"AAEA,OAAO,MAAMA,aAAa,GAAGA,CAACC,IAA8B,EAAEC,EAAU,KAAmB;EACzF,IAAI,CAACD,IAAI,EAAE,OAAO,IAAI;EACtB,IAAIA,IAAI,CAACC,EAAE,KAAKA,EAAE,EAAE,OAAOD,IAAI;EAE/B,KAAK,MAAME,KAAK,IAAIF,IAAI,CAACG,QAAQ,EAAE;IACjC,MAAMC,KAAK,GAAGL,aAAa,CAACG,KAAK,EAAED,EAAE,CAAC;IACtC,IAAIG,KAAK,EAAE,OAAOA,KAAK;EACzB;EAEA,OAAO,IAAI;AACb,CAAC;AAED,OAAO,MAAMC,qBAAqB,GAAIC,KAAY,IAAa;EAC7D,IAAIC,KAAK,GAAGD,KAAK,CAACE,WAAW,GAAG,CAAC,GAAG,CAAC;EAErC,KAAK,MAAMN,KAAK,IAAII,KAAK,CAACH,QAAQ,EAAE;IAClCI,KAAK,IAAIF,qBAAqB,CAACH,KAAK,CAAC;EACvC;EAEA,OAAOK,KAAK;AACd,CAAC;AAED,OAAO,MAAME,oBAAoB,GAAIH,KAAY,IAAK;EACpD,IAAI,CAACA,KAAK,CAACI,MAAM,EAAE;EAEnB,MAAMC,oBAAoB,GAAGL,KAAK,CAACI,MAAM,CAACP,QAAQ,CAACS,KAAK,CAACV,KAAK,IAAIA,KAAK,CAACM,WAAW,CAAC;EACpFF,KAAK,CAACI,MAAM,CAACF,WAAW,GAAGG,oBAAoB;EAE/CF,oBAAoB,CAACH,KAAK,CAACI,MAAM,CAAC;AACpC,CAAC;AAED,OAAO,MAAMG,gBAAgB,GAAIC,OAAe,IAAK;EACnD;EACAC,KAAK,CAACD,OAAO,CAAC;AAChB,CAAC;;AAED;AACA,OAAO,MAAME,YAAY,GAAGA,CAACN,MAAa,EAAER,KAAY,KAAc;EACpE;EACA,IAAIQ,MAAM,CAACT,EAAE,KAAKC,KAAK,CAACD,EAAE,EAAE,OAAO,IAAI;EAEvC,KAAK,MAAMgB,UAAU,IAAIP,MAAM,CAACP,QAAQ,EAAE;IACxC,IAAIa,YAAY,CAACC,UAAU,EAAEf,KAAK,CAAC,EAAE,OAAO,IAAI;EAClD;EAEA,OAAO,KAAK;AACd,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}